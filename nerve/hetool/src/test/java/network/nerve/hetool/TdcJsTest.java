/**
 * MIT License
 * <p>
 * Copyright (c) 2017-2018 nuls.io
 * <p>
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * <p>
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * <p>
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
package network.nerve.hetool;

import io.nuls.core.parse.JSONUtils;
import network.nerve.hetool.model.TbcUTXO;
import network.nerve.hetool.util.TbcTxUtil;
import org.graalvm.polyglot.Context;
import org.graalvm.polyglot.Source;
import org.graalvm.polyglot.Value;
import org.junit.Before;
import org.junit.Test;

import java.io.IOException;
import java.io.InputStream;
import java.nio.charset.StandardCharsets;
import java.util.HashMap;
import java.util.List;
import java.util.Map;


/**
 * @author: PierreLuo
 * @date: 2024/5/28
 */
public class TdcJsTest {

    Context context;
    String[] pubKeys = new String[]{
            "024173f84acb3de56b3ef99894fa3b9a1fe4c48c1bdc39163c37c274cd0334ba75",
            "02c0a82ba398612daa4133a891b3f52832114e0d3d6210348543f1872020556ded",
            "03b77df3d540817d20d3414f920ccec61b3395e1dc1ef298194e5ff696e038edd9"
    };

    @Before
    public void before() throws IOException {
        Map<String, String> options = new HashMap<>();
        options.put("js.webassembly", "true");
        ClassLoader classLoader = HeToolBootstrap.class.getClassLoader();
        String scriptContent;
        try (InputStream inputStream = classLoader.getResourceAsStream("js/tbc.contract.js")) {
            if (inputStream == null) {
                throw new IOException("找不到 js/tbc.contract.js");
            }
            scriptContent = new String(inputStream.readAllBytes(), StandardCharsets.UTF_8);
        }

        // 创建 Source
        Source mysource = Source.newBuilder("js", scriptContent, "tbc")
                .mimeType("application/javascript")
                .build();

        context = Context.newBuilder()
                .allowAllAccess(true)
                .allowIO(true)
                .options(options)
                .build();
        context.eval(mysource);
    }

    @Test
    public void testTbcAddr() {
        Value va = context.eval("js", String.format("contract.tbc.Address.fromPrivateKey(contract.tbc.PrivateKey.fromString('%s')).toString()", "L2rE3Rc5TCZUkR1fw9UGRLvjPmnFbEux8YvfeVa1hm6ZhTjxhCKF"));
        System.out.println(va.asString());
    }

    @Test
    public void testTbcFT() {
        Value va = context.eval("js", "contract.FT");
        Map map = va.as(Map.class);
        System.out.println(map);
    }

    @Test
    public void testGetFTunlockSwap() {
        Value va = context.eval("js", "contract.getFTunlockSwap()");
        Map map = va.as(Map.class);
        System.out.println(map);
    }


    @Test
    public void testMultiTransferTBC() throws Exception {
        String multiSigAddress = "FJ5buUdNQ8FBpwh3ZT2W1peVUidHRvje2m";
        String address_to = "1Gb3miXLcLKdm1su17jjfXviqXVRTFnE9E";
        String amount_tbc = "0.103893";
        List utxos = JSONUtils.json2list("[{\"txId\":\"7d6a31759bc98aeaec0016b1d54785245d52951599f6614ca88c37e971cd60d4\",\"outputIndex\":0,\"script\":\"527c01217f01217f5279527952797e7ea914865f135c66fb464723414179f6180fa5fed1c1ac8853ae\",\"satoshis\":2000},{\"txId\":\"39546fd19c4d106ecd9a4d6cd7289b73a229fd36199e3ef12d905257b070f67c\",\"outputIndex\":4,\"script\":\"527c01217f01217f5279527952797e7ea914865f135c66fb464723414179f6180fa5fed1c1ac8853ae\",\"satoshis\":6000},{\"txId\":\"cf574649eef7ebe647a3e6adfaaa68b1048d8a4b95f6651db99838ea2735966f\",\"outputIndex\":4,\"script\":\"527c01217f01217f5279527952797e7ea914865f135c66fb464723414179f6180fa5fed1c1ac8853ae\",\"satoshis\":96000}]", Map.class);//hTool查询
        Map map = TbcTxUtil.buildMultiSigTransaction_sendTBC(context, multiSigAddress, address_to, amount_tbc, utxos, "888888887d6a31759bc98aeaec0016b1d54785245d52951599f6614ca88c37e971cd60d4");
        System.out.println(map);
        //String tx = TbcTxUtil.finishMultiSigTransaction_sendTBC(context, map.get("txraw").toString(),
        //        new String[][]{
        //            new String[]{
        //                    "304402201fea90086e4c909c4e034a54af9b41bc8ca91fedffef579afe1b5b5154ebebf902205d32c541c310589677cb3f0cc986b8d4a49172274f307272455a574d308c313a41",
        //                    "3045022100c82ab9d9bdffdaa1a91fb199e75a314356f7f5db3c54c75ddeb7dbda1e24c7b6022045008d466428d42a185b0110ea04331367effb03a4cc5789a36be8755ba3106e41"}
        //}, pubKeys);
        //System.out.println(tx);
    }



    @Test
    public void testMultiTransferFT() throws Exception {
        String multiSigAddress = "FBeMrqQWFkhBJt6rA2yKxVWg9Jeiww76Pr";
        String address_to = "14Wo6L9A62gdkBqEKw2A4PxC467jvjJAP2";
        String transferTokenAmount = "3.3";
        String tokenId = "1707b71efdc207a476e7fefd6f7fa880a2201032c2b1d0a3cc20118ded505da4";
        Map tokenInfo = JSONUtils.json2map("{\"name\":\"test_usdt\",\"symbol\":\"test_usdt\",\"decimal\":6,\"totalSupply\":210000000,\"codeScript\":\"59796b51798255947f05465461706588537f587f587f587f587f587f587f7581760087646c76550128957f01287f756b756b687c81760087646c76540128957f01287f756b756b68937c81760087646c76530128957f01287f756b756b68937c81760087646c76520128957f01287f756b756b68937c81760087646c76510128957f01287f756b756b68937c81760087646c76000128957f01287f756b756b68936c756b756ba87e6c7e527952797e6b53796b6bbb7e7e6c7ea87e6ba86c7e7ea8a856ba01207f75886c517f7701147f517f758176008763755179a988ad6751885279a9886b7e6c7e7ea87e7e7ea8a87801207f7588a855ba88ad687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01247f75766b01207f75557a887287636c756b6b676c24f3311dc9689ec6a310e8ffe74893242755c3b8fc9eaa8936f5c2fe1e657dacc400000000886b6b68687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b68765287008857886c6c7c6b6b6b7652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b686876528700886c6c00887551886c6ca857ba877721ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff756a158a07aa9cc64d71ca194e2d695eb4d545e871235f000532436f6465\",\"tapeScript\":\"006a300020676ffebe000000000000000000000000000000000000000000000000000000000000000000000000000000000000010609746573745f7573647409746573745f75736474054654617065\",\"contractTxid\":\"1707b71efdc207a476e7fefd6f7fa880a2201032c2b1d0a3cc20118ded505da4\"}");
        TbcUTXO umtxo = JSONUtils.json2pojo("{\"txId\":\"a5535f80f4053652d4b63a0141e06575fd87bf891f9e947fed8d31c08359cb10\",\"outputIndex\":4,\"script\":\"527c01217f01217f5279527952797e7ea9143fc8327ee3e748b925763179171ee7b8d79873668853ae\",\"satoshis\":996000}", TbcUTXO.class);
        List ftutxos = JSONUtils.json2list("[{\"txId\":\"931a15cb26cb72dc28edca3aa670075d9b4c981e465f57a28284a43fdccf0bfb\",\"outputIndex\":2,\"script\":\"59796b51798255947f05465461706588537f587f587f587f587f587f587f7581760087646c76550128957f01287f756b756b687c81760087646c76540128957f01287f756b756b68937c81760087646c76530128957f01287f756b756b68937c81760087646c76520128957f01287f756b756b68937c81760087646c76510128957f01287f756b756b68937c81760087646c76000128957f01287f756b756b68936c756b756ba87e6c7e527952797e6b53796b6bbb7e7e6c7ea87e6ba86c7e7ea8a856ba01207f75886c517f7701147f517f758176008763755179a988ad6751885279a9886b7e6c7e7ea87e7e7ea8a87801207f7588a855ba88ad687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01247f75766b01207f75557a887287636c756b6b676c24f3311dc9689ec6a310e8ffe74893242755c3b8fc9eaa8936f5c2fe1e657dacc400000000886b6b68687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b68765287008857886c6c7c6b6b6b7652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b686876528700886c6c00887551886c6ca857ba877721ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff756a15b80d8ae21b391469ce0e6e701b9d6fcca6feff25010532436f6465\",\"satoshis\":2000,\"ftBalance\":75900000}]", Map.class);
        List<String> preTXs = List.of("0a00000002cff211a616d9a7122e3548c6f4bac53f2ca7928eb2e00e591aa8e45c13c0a29c05000000f700483045022100ff6b7d41fed9d22c385fd3d1d4ac4cd3d8281c7aeeb54db28a97ea1578c206ac022035d8b60ee90a799b5c2dd04c9a17f90096a0f45368a7ec8cdf0565df2c4c9f454147304402204ec25a98ef15e467d7b81e6969aa482bab84f55a77a796d43a83e8aad84933580220440e2a7c0546963cb289d94e99d6172ab7a5027f51a4f262ee4b9ee2ef60b074414c63024173f84acb3de56b3ef99894fa3b9a1fe4c48c1bdc39163c37c274cd0334ba7502c0a82ba398612daa4133a891b3f52832114e0d3d6210348543f1872020556ded03b77df3d540817d20d3414f920ccec61b3395e1dc1ef298194e5ff696e038edd9ffffffff10cb5983c0318ded7f949e1f89bf87fd7565e041013ab6d4523605f4805f53a502000000fd96065108d0070000000000001c15268aea733ecab3ca3fb04897083d2de883d73997000532436f64652006df51d51467da646559ed9c99cd14026aa3c45aa37493cafceded6ab27855bb021c060800000000000000004c4f006a300000000000000000a05a3200000000000000000000000000000000000000000000000000000000000000000000000000010609746573745f7573647409746573745f757364740546546170655208d0070000000000001c15b80d8ae21b391469ce0e6e701b9d6fcca6feff25010532436f64652006df51d51467da646559ed9c99cd14026aa3c45aa37493cafceded6ab27855bb021c060800000000000000004c4f006a30000000000000000060248604000000000000000000000000000000000000000000000000000000000000000000000000010609746573745f7573647409746573745f757364740546546170655208848208000000000029527c01217f01217f5279527952797e7ea9143fc8327ee3e748b925763179171ee7b8d79873668853ae000129525157100a00000000000000020000000600000020e3abdee0f17ed3625f16d7de0313f06fe2b4b310e4280dee3e1b059e61077dde2035af98eb6cfe42151c91b29fcdb294a73de27c00c8f8f1149066551264bc55254c50d007000000000000bd5b70ecaf7197affcb119288bef2a1e67e27e86ec1371e8f41332c5384e22700000000000000000a2383ee50732204e93a5b036e9c7b3c2086111b8454a4f5d2bea2eb9dbaca96808d0070000000000001c15b80d8ae21b391469ce0e6e701b9d6fcca6feff25010532436f64652006df51d51467da646559ed9c99cd14026aa3c45aa37493cafceded6ab27855bb021c064c78000000000000000090d1d7430252e482f14f324f4c48085a56076710fee6ddb6e07aed3fc34a7c2310090500000000001fe070a3fdae2d35976680dfa1d8f569958389767185a7c87ac31c82bbe71350249208000000000069dde17d6259809410b1cc58fd111fefa574a3d16c292bfa07b0efcd3aeec6d552483045022100c5ff8300eaa3f233100d66d48cd61bc9c0a07c5214e776e4f5eb7a1a08a2add102206ba7b034d85112e4e8fb976b3e0c8abbe8f785899a0b9892d34301f0ff123e8d4121035375057c52f1267ac8eb31b355dabf939bd1a9759047b8f845bf4b0f608db52f4c50cff211a616d9a7122e3548c6f4bac53f2ca7928eb2e00e591aa8e45c13c0a29c05000000ffffffff10cb5983c0318ded7f949e1f89bf87fd7565e041013ab6d4523605f4805f53a502000000ffffffff100a00000000000000020000000600000020e3abdee0f17ed3625f16d7de0313f06fe2b4b310e4280dee3e1b059e61077dde2035af98eb6cfe42151c91b29fcdb294a73de27c00c8f8f1149066551264bc55254cc8d007000000000000bd5b70ecaf7197affcb119288bef2a1e67e27e86ec1371e8f41332c5384e22700000000000000000a2383ee50732204e93a5b036e9c7b3c2086111b8454a4f5d2bea2eb9dbaca968d007000000000000916cb9a8060483e2b589c1a0abf63b04bb17defb9c45d081748494d1f14e6bec000000000000000090d1d7430252e482f14f324f4c48085a56076710fee6ddb6e07aed3fc34a7c2310090500000000001fe070a3fdae2d35976680dfa1d8f569958389767185a7c87ac31c82bbe713500824920800000000002069dde17d6259809410b1cc58fd111fefa574a3d16c292bfa07b0efcd3aeec6d500100a0000000000000002000000050000004c5058b9ffa78b9c7d01f6824982096b62d67cba62dab966b662d597ed100b12f9cf04000000ffffffffcff211a616d9a7122e3548c6f4bac53f2ca7928eb2e00e591aa8e45c13c0a29c02000000ffffffff2027cbb727215425f69b6bc8183c8df014e70b676178cb425b3e72d63be4adf42c4c50d007000000000000bd5b70ecaf7197affcb119288bef2a1e67e27e86ec1371e8f41332c5384e22700000000000000000d4b23763ef6485fcae39cd3f52f6da944b63a0795a5b5e0f7520931cd6a5768808d0070000000000001c15b80d8ae21b391469ce0e6e701b9d6fcca6feff25010532436f64652006df51d51467da646559ed9c99cd14026aa3c45aa37493cafceded6ab27855bb021c060800000000000000004c4f006a300000000000000000007fb804000000000000000000000000000000000000000000000000000000000000000000000000010609746573745f7573647409746573745f7573647405465461706528a0320f000000000069dde17d6259809410b1cc58fd111fefa574a3d16c292bfa07b0efcd3aeec6d5ffffffff05d007000000000000fd1c0659796b51798255947f05465461706588537f587f587f587f587f587f587f7581760087646c76550128957f01287f756b756b687c81760087646c76540128957f01287f756b756b68937c81760087646c76530128957f01287f756b756b68937c81760087646c76520128957f01287f756b756b68937c81760087646c76510128957f01287f756b756b68937c81760087646c76000128957f01287f756b756b68936c756b756ba87e6c7e527952797e6b53796b6bbb7e7e6c7ea87e6ba86c7e7ea8a856ba01207f75886c517f7701147f517f758176008763755179a988ad6751885279a9886b7e6c7e7ea87e7e7ea8a87801207f7588a855ba88ad687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01247f75766b01207f75557a887287636c756b6b676c24f3311dc9689ec6a310e8ffe74893242755c3b8fc9eaa8936f5c2fe1e657dacc400000000886b6b68687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b68765287008857886c6c7c6b6b6b7652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b686876528700886c6c00887551886c6ca857ba877721ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff756a15268aea733ecab3ca3fb04897083d2de883d73997000532436f646500000000000000004f006a300000000000000000a05a3200000000000000000000000000000000000000000000000000000000000000000000000000010609746573745f7573647409746573745f75736474054654617065d007000000000000fd1c0659796b51798255947f05465461706588537f587f587f587f587f587f587f7581760087646c76550128957f01287f756b756b687c81760087646c76540128957f01287f756b756b68937c81760087646c76530128957f01287f756b756b68937c81760087646c76520128957f01287f756b756b68937c81760087646c76510128957f01287f756b756b68937c81760087646c76000128957f01287f756b756b68936c756b756ba87e6c7e527952797e6b53796b6bbb7e7e6c7ea87e6ba86c7e7ea8a856ba01207f75886c517f7701147f517f758176008763755179a988ad6751885279a9886b7e6c7e7ea87e7e7ea8a87801207f7588a855ba88ad687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01247f75766b01207f75557a887287636c756b6b676c24f3311dc9689ec6a310e8ffe74893242755c3b8fc9eaa8936f5c2fe1e657dacc400000000886b6b68687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b68765287008857886c6c7c6b6b6b7652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b686876528700886c6c00887551886c6ca857ba877721ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff756a15b80d8ae21b391469ce0e6e701b9d6fcca6feff25010532436f646500000000000000004f006a30000000000000000060248604000000000000000000000000000000000000000000000000000000000000000000000000010609746573745f7573647409746573745f75736474054654617065848208000000000029527c01217f01217f5279527952797e7ea9143fc8327ee3e748b925763179171ee7b8d79873668853ae00000000");
        List<String> prepreTxDatas = List.of("57100a000000000000000200000005000000205d0f0e2fcb5416c3f2bf20ecb225f74143e73a5c451bfa483959dfffd39a50642027cbb727215425f69b6bc8183c8df014e70b676178cb425b3e72d63be4adf42c4c50d007000000000000bd5b70ecaf7197affcb119288bef2a1e67e27e86ec1371e8f41332c5384e22700000000000000000d4b23763ef6485fcae39cd3f52f6da944b63a0795a5b5e0f7520931cd6a5768808d0070000000000001c15b80d8ae21b391469ce0e6e701b9d6fcca6feff25010532436f64652006df51d51467da646559ed9c99cd14026aa3c45aa37493cafceded6ab27855bb021c064c5000000000000000008415a176fa6a1b1a9c8037ec1a39e9c58edae531b210b34af05689bc87df2ff4a0320f000000000069dde17d6259809410b1cc58fd111fefa574a3d16c292bfa07b0efcd3aeec6d552");
        String contractTx = "0a0000000258b9ffa78b9c7d01f6824982096b62d67cba62dab966b662d597ed100b12f9cf04000000f60047304402203fa61ead769aae8206e8288895932eef5906d49f5021c5ca8dcd7c10c3d97cd5022011a2461dc66e8d45ccfc2bcbde75fba403f60faf1722710bd06f0e3906f741bb4147304402201f9c517aa06ae914d0091cd5937e99cb69d68b0dcd89c97cab008ee0579618a102203baf49c45e0f91016406955cbc89db40dcbabdd17700caa3c06a922740173859414c63024173f84acb3de56b3ef99894fa3b9a1fe4c48c1bdc39163c37c274cd0334ba7502c0a82ba398612daa4133a891b3f52832114e0d3d6210348543f1872020556ded03b77df3d540817d20d3414f920ccec61b3395e1dc1ef298194e5ff696e038edd9ffffffffcff211a616d9a7122e3548c6f4bac53f2ca7928eb2e00e591aa8e45c13c0a29c02000000fd96065108d0070000000000001c15268aea733ecab3ca3fb04897083d2de883d73997000532436f64652006df51d51467da646559ed9c99cd14026aa3c45aa37493cafceded6ab27855bb021c060800000000000000004c4f006a300000000000000000808d5b00000000000000000000000000000000000000000000000000000000000000000000000000010609746573745f7573647409746573745f757364740546546170655208d0070000000000001c15b80d8ae21b391469ce0e6e701b9d6fcca6feff25010532436f64652006df51d51467da646559ed9c99cd14026aa3c45aa37493cafceded6ab27855bb021c060800000000000000004c4f006a300000000000000000007fb804000000000000000000000000000000000000000000000000000000000000000000000000010609746573745f7573647409746573745f757364740546546170655208a0320f000000000029527c01217f01217f5279527952797e7ea9143fc8327ee3e748b925763179171ee7b8d79873668853ae000129525157100a0000000000000002000000050000002015d94783d024e6aab4742ca5646b78191e64eb353644c0595b368f3c1b39963c20d030cf0cef8fd269e64a47f090d31daeac93b9e50ebbf3e195e23d7d5dad34a04c50d007000000000000bd5b70ecaf7197affcb119288bef2a1e67e27e86ec1371e8f41332c5384e22700000000000000000d4b23763ef6485fcae39cd3f52f6da944b63a0795a5b5e0f7520931cd6a5768808d0070000000000001c15b80d8ae21b391469ce0e6e701b9d6fcca6feff25010532436f64652006df51d51467da646559ed9c99cd14026aa3c45aa37493cafceded6ab27855bb021c064c5000000000000000004680a846b11f240e3171320c65f8fe73e8af36acf1c1f2ef10a9797a00f6f73ad4aa0d000000000069dde17d6259809410b1cc58fd111fefa574a3d16c292bfa07b0efcd3aeec6d55247304402206d57011b93b9112aaef9cc83390cfb4300e0839739d5be147ce5278e87ca765702205307ca89d656c2b86ac8699c1c084080276b1c73b97576d6ea355f79825ac8bc41210290fc38beabd8727fae2f8c7e88df4dd24a9f4f0a97296f651067609854f7da684c5058b9ffa78b9c7d01f6824982096b62d67cba62dab966b662d597ed100b12f9cf04000000ffffffffcff211a616d9a7122e3548c6f4bac53f2ca7928eb2e00e591aa8e45c13c0a29c02000000ffffffff100a00000000000000020000000600000020ac36152f02e5404f9b304026416c13e48920c01baf23fe9cbff89b377f2329f6207ad43b727c63b5ee5d5cfcbc730101fb4f26d926f415a2209d68975022db28d84ca0d007000000000000916cb9a8060483e2b589c1a0abf63b04bb17defb9c45d081748494d1f14e6bec0000000000000000cef30c36ecbb5cba83ce3afd834fd6e56bb10dddcc766f84da59b4e3db1ccc2ed007000000000000911f016b521b2c5ad953197ec18e5ebfc3273c7a5c59f9c976f8612da23880340000000000000000624d0b3f62009b06c88235e8ae6ee332fc7787b12307edb80e9c2f989b3e14590840420f00000000002069dde17d6259809410b1cc58fd111fefa574a3d16c292bfa07b0efcd3aeec6d528a739ed53020000000652490117ffe7fc9300b34af04efb948c28c601816076cccb72d9a8a2fe9d3b100a0000000000000002000000060000004c503f25b8bf00f48dc37a4f20255c50e16cdce24c62ccad085c70a88f618ec0172104000000ffffffff3f25b8bf00f48dc37a4f20255c50e16cdce24c62ccad085c70a88f618ec0172102000000ffffffff2035af98eb6cfe42151c91b29fcdb294a73de27c00c8f8f1149066551264bc55254c50d007000000000000bd5b70ecaf7197affcb119288bef2a1e67e27e86ec1371e8f41332c5384e22700000000000000000a2383ee50732204e93a5b036e9c7b3c2086111b8454a4f5d2bea2eb9dbaca96808d0070000000000001c15b80d8ae21b391469ce0e6e701b9d6fcca6feff25010532436f64652006df51d51467da646559ed9c99cd14026aa3c45aa37493cafceded6ab27855bb021c060800000000000000004c4f006a300000000000000000800c1405000000000000000000000000000000000000000000000000000000000000000000000000010609746573745f7573647409746573745f757364740546546170654c5010090500000000001fe070a3fdae2d35976680dfa1d8f569958389767185a7c87ac31c82bbe71350249208000000000069dde17d6259809410b1cc58fd111fefa574a3d16c292bfa07b0efcd3aeec6d5ffffffff05d007000000000000fd1c0659796b51798255947f05465461706588537f587f587f587f587f587f587f7581760087646c76550128957f01287f756b756b687c81760087646c76540128957f01287f756b756b68937c81760087646c76530128957f01287f756b756b68937c81760087646c76520128957f01287f756b756b68937c81760087646c76510128957f01287f756b756b68937c81760087646c76000128957f01287f756b756b68936c756b756ba87e6c7e527952797e6b53796b6bbb7e7e6c7ea87e6ba86c7e7ea8a856ba01207f75886c517f7701147f517f758176008763755179a988ad6751885279a9886b7e6c7e7ea87e7e7ea8a87801207f7588a855ba88ad687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01247f75766b01207f75557a887287636c756b6b676c24f3311dc9689ec6a310e8ffe74893242755c3b8fc9eaa8936f5c2fe1e657dacc400000000886b6b68687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b68765287008857886c6c7c6b6b6b7652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b686876528700886c6c00887551886c6ca857ba877721ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff756a15268aea733ecab3ca3fb04897083d2de883d73997000532436f646500000000000000004f006a300000000000000000808d5b00000000000000000000000000000000000000000000000000000000000000000000000000010609746573745f7573647409746573745f75736474054654617065d007000000000000fd1c0659796b51798255947f05465461706588537f587f587f587f587f587f587f7581760087646c76550128957f01287f756b756b687c81760087646c76540128957f01287f756b756b68937c81760087646c76530128957f01287f756b756b68937c81760087646c76520128957f01287f756b756b68937c81760087646c76510128957f01287f756b756b68937c81760087646c76000128957f01287f756b756b68936c756b756ba87e6c7e527952797e6b53796b6bbb7e7e6c7ea87e6ba86c7e7ea8a856ba01207f75886c517f7701147f517f758176008763755179a988ad6751885279a9886b7e6c7e7ea87e7e7ea8a87801207f7588a855ba88ad687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01247f75766b01207f75557a887287636c756b6b676c24f3311dc9689ec6a310e8ffe74893242755c3b8fc9eaa8936f5c2fe1e657dacc400000000886b6b68687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b687652876375527952797e6b6bbb7e7e6c7ea87e7e7ea8a86c6c766c6c01207f75557a8872886b6b68765287008857886c6c7c6b6b6b7652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b68687652876375768276014f876355947f05465461706588537f7c756c765895527a7c7f587f7581760087646c6c76597959797e886b6b686c7c946b756ba87e6bbb6c7e7e6c6c6c537a6c7e6b6b6b6b6775014f876352798255947f0546546170658700887568bb7e6c6c6c537a6c7e6b6b6b6b686876528700886c6c00887551886c6ca857ba877721ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff756a15b80d8ae21b391469ce0e6e701b9d6fcca6feff25010532436f646500000000000000004f006a300000000000000000007fb804000000000000000000000000000000000000000000000000000000000000000000000000010609746573745f7573647409746573745f75736474054654617065a0320f000000000029527c01217f01217f5279527952797e7ea9143fc8327ee3e748b925763179171ee7b8d79873668853ae00000000";
        String privateKeyAny = "cQx11rCDpvCGZx2W6Fqdg55ZSnbKf8DhazsNxfVTDGCQQtvJWccL";
        Map map = TbcTxUtil.buildMultiSigTransaction_transferFT(context, multiSigAddress, address_to, tokenId, tokenInfo, transferTokenAmount, umtxo, ftutxos, preTXs, prepreTxDatas, contractTx, privateKeyAny, "");
        System.out.println(map);
        String tx = TbcTxUtil.finishMultiSigTransaction_transferFT(context, map.get("txraw").toString(),
                new String[][]{
                        new String[]{
                                "304402203d69959322deec7ff3a25f45fd1a4adc0620b6688a2dadcac1b609809e4c152a0220735dad9f0c9d9fec0eb1398f7741e86d332961f70c1df4422191bb3e863846d341",
                                "3045022100d11c388c791d58605a406be02fbb09a008ad068ef300dff8dc82d59cf02014d60220663a7f332df16c7704fd304a7a238d770bec3083e4cd54255281dc55f0464edc41"}
                }, pubKeys);
        System.out.println(tx);
    }



}
